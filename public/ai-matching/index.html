<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YHD AI Matching</title>
    <!-- 既存のスタイルをベースにする -->
    <link rel="stylesheet" href="../admin/style.css">
    <!-- 専用スタイル -->
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
</head>

<body>

    <div class="app-container">
        <header class="main-header">
            <div class="header-left">
                <a href="../admin/index.html" class="home-btn"><i class="fa-solid fa-house"></i></a>
                <h1 class="app-title">YHD AI Matching</h1>
            </div>

            <div class="header-actions">
                <!-- ページ1用ボタン -->
                <button id="header-analyze-btn" class="header-btn primary-btn" onclick="startAnalysis()">
                    <i class="fa-solid fa-wand-magic-sparkles"></i> 診断する
                </button>

                <!-- ページ2用ボタン -->
                <div id="header-result-actions" style="display: none; gap: 10px;">
                    <button id="header-save-btn" class="header-btn secondary-btn" onclick="saveResultImage()">
                        <i class="fa-solid fa-download"></i> 画像で保存
                    </button>
                    <button class="header-btn secondary-btn" onclick="retryAnalysis()">
                        <i class="fa-solid fa-arrow-rotate-left"></i> もう一度
                    </button>
                </div>
            </div>
        </header>

        <!-- 1. 入力画面 (撮影画面) -->
        <section id="input-screen" class="screen active">
            <div class="photo-columns">
                <!-- 正面 -->
                <div class="photo-column">
                    <h2 class="column-title">Front</h2>
                    <div class="photo-placeholder" id="placeholder-front" onclick="triggerCamera('front')">
                        <i class="fa-solid fa-camera"></i>
                    </div>
                    <div class="photo-preview" id="preview-front" style="display: none;"
                        onclick="triggerCamera('front')">
                        <img src="" alt="Front Preview">
                    </div>
                    <!-- ダミーinput -->
                    <input type="file" id="input-front" accept="image/*" capture="environment" hidden
                        onchange="handleFileSelect(event, 'front')">
                </div>

                <!-- サイド -->
                <div class="photo-column">
                    <h2 class="column-title">Side</h2>
                    <div class="photo-placeholder" id="placeholder-side" onclick="triggerCamera('side')">
                        <i class="fa-solid fa-camera"></i>
                    </div>
                    <div class="photo-preview" id="preview-side" style="display: none;" onclick="triggerCamera('side')">
                        <img src="" alt="Side Preview">
                    </div>
                    <input type="file" id="input-side" accept="image/*" capture="environment" hidden
                        onchange="handleFileSelect(event, 'side')">
                </div>

                <!-- バック -->
                <div class="photo-column">
                    <h2 class="column-title">Back</h2>
                    <div class="photo-placeholder" id="placeholder-back" onclick="triggerCamera('back')">
                        <i class="fa-solid fa-camera"></i>
                    </div>
                    <div class="photo-preview" id="preview-back" style="display: none;" onclick="triggerCamera('back')">
                        <img src="" alt="Back Preview">
                    </div>
                    <input type="file" id="input-back" accept="image/*" capture="environment" hidden
                        onchange="handleFileSelect(event, 'back')">
                </div>
            </div>
            <!-- アクションエリアはヘッダーに移動したため削除 -->
        </section>

        <!-- 2. 結果画面 -->
        <section id="result-screen" class="screen">
            <div class="result-layout">
                <!-- 左側: 結果テキスト -->
                <div class="result-info-panel glass-panel">
                    <div class="score-container">
                        <div class="score-label">Matching Score</div>
                        <div class="score-value">88<span class="percent">%</span></div>
                    </div>
                    <div class="reason-container">
                        <h3></h3>
                        <p class="reason-text">
                            お客様の骨格と髪質に対して、今回のスタイルは非常に高い親和性を示しています。
                        </p>
                    </div>
                    <!-- ボタン群はヘッダーに移動 -->
                </div>

                <!-- 右側: 画像比較 -->
                <div class="result-image-panel">
                    <div class="after-image-container">
                        <img src="https://placehold.jp/800x1000.png?text=After%20Image" alt="After Style"
                            class="after-image" id="result-after-img">
                        <div class="before-image-overlay">
                            <span class="overlay-label">Before</span>
                            <img src="https://placehold.jp/300x400.png?text=Before" alt="Before Style"
                                class="before-image" id="result-before-img">
                        </div>
                        <span class="overlay-label-after">After</span>
                    </div>
                </div>
            </div>
        </section>

    </div>

    <!-- html2canvas -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script type="module" src="script.js"></script>
</body>

</html>