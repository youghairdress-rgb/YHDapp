YHDapp Refactored ProjectWelcome to the refactored version of the YHDapp LIFF application.This project has been restructured for optimal security, performance, and maintainability by migrating all business logic to a serverless backend using Cloud Functions for Firebase.New Architecture OverviewFrontend (Firebase Hosting): The /public directory contains all static assets (HTML, JS, CSS). The client-side JavaScript is now responsible ONLY for UI rendering and user interactions. It no longer contains any Firebase configuration keys or direct database access code.Backend (Cloud Functions): The /functions directory contains the Node.js backend. All database operations, business logic (e.g., checking booking availability), and interactions with Firebase services are handled here securely.Communication: The frontend communicates with the backend via a secure API. A Firebase ID Token, obtained after a successful LIFF login, is used for authenticating every request.🆘 トラブルシューティング・ガイドA. LIFFアプリが「読み込み中」から進まない場合デプロイ後に「読み込み中」の画面から進まない場合、フロントエンド（LIFFアプリ）とバックエンド（Cloud Functions）の連携がうまくいっていない可能性が高いです。手順1: フロントエンドのエラーを確認する (最重要)PCのGoogle ChromeブラウザでLIFFアプリのURL（例: https://yhddatebase.web.app/）を開きます。F12キーを押してデベロッパーツールを開き、「Console」タブを確認します。表示されているログと赤色のエラーメッセージを私に教えてください。手順2: バックエンドのエラーを確認するFirebaseコンソールでyhddatebaseプロジェクトを開きます。左メニューの「Functions」→ api 関数の右側メニュー「︙」→「ログを表示」を選択します。LIFFアプリを再読み込みし、赤色のエラーメッセージが表示されないか確認します。B. デプロイ時にエラーが出る場合エラー: Functions codebase could not be analyzed successfullyfunctions/index.js の文法エラーです。ターミナルで yhdapp/functions ディレクトリに移動し、node --check index.js を実行してエラー箇所を特定してください。エラー: npm ci can only install packages when...`package.json と package-lock.json に食い違いがあります。yhdapp/functions ディレクトリで npm install を実行し、package-lock.json を再生成してからデプロイしてください。🚀 デプロイ手順 (初心者向け詳細ガイド)Step 0: 事前準備 (FirebaseとLINEの設定)Firebase でプロジェクトが作成済みであること。LINE Developers でLIFFチャネルが2つ（ユーザー向け・管理者向け）作成済みであること。Step 1: 開発環境のセットアップNode.jsのインストール:PCにNode.js (バージョン18以降を推奨) がインストールされていることを確認してください。Firebase CLIのインストール:ターミナル（コマンドプロンプトやPowerShell）で以下のコマンドを実行します。npm install -g firebase-tools
Firebaseへのログイン:続けて、ターミナルで以下のコマンドを実行し、ブラウザでGoogleアカウントにログインします。firebase login
Step 1.5: プロジェクトとの連携ターミナルで yhdapp フォルダに移動します。プロジェクト選択コマンドの実行:以下のコマンドを実行し、対話形式でこのフォルダとFirebaseプロジェクトを紐付けます。firebase use --add
プロジェクトの選択:表示されるプロジェクト一覧から、キーボードの矢印キーで yhddatebase を選択し、Enterキーを押します。エイリアス（ニックネーム）の設定:What alias do you want to use? と聞かれたら、default と入力してEnterキーを押します。Step 2: バックエンドの準備functions ディレクトリに移動:ターミナルで yhdapp の中にある functions ディレクトリに移動します。cd path/to/your/yhdapp/functions
依存関係のインストール:バックエンドに必要なライブラリをインストールします。npm install
完了すると、node_modules フォルダと package-lock.json ファイルが生成されます。Step 3: 環境変数の設定 (新しい方式).env ファイルの作成:yhdapp/functions/ ディレクトリ内に、.env.yhddatebase という名前の新しいファイルを正確に作成します。（yhddatebase の部分はご自身のプロジェクトIDです）ファイルに秘密情報を記述:作成した .env.yhddatebase ファイルに、以下の内容をコピー＆ペーストして保存します。LIFF_USER_ID="2008029428-GNNaR1Nm"
LIFF_ADMIN_ID="2008029428-ANbgw3b6"
Step 4: Firebaseへのデプロイルートディレクトリへ移動:ターミナルで yhdapp のルートディレクトリに戻ります。cd ..
デプロイコマンドの実行:以下のコマンドで、全ての変更をFirebaseにアップロードします。firebase deploy
Step 5: LIFFエンドポイントURLの確認デプロイ完了後、ターミナルに表示される Hosting URL (例: https://yhddatebase.web.app) が、あなたのLIFFアプリのURLです。LINE Developersコンソールで、各LIFFチャネルのエンドポイントURLが正しく設定されているか（例: ユーザー向けは /、管理者向けは /admin/）を最終確認してください。